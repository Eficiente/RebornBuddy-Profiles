<?xml version="1.0" encoding="utf-8"?>
<!--
Profile: [O] I Can Dig It III
Author: y2krazy
Version: 1.0.0
Required Level: 50
Required Teleport Location:
	Camp Bluefog
	Camp Drybone
Required User Interaction:
	This profile should be AFKable.
Required Setup:
	Acquire Camp Bluefog and Camp Drybone Aetherytes
	Set Gear Set #1 to your preferred combat class.
	Set Gear Set #10 to Miner.
	ONLY run once per day - you can only get 1 map every 18 hours.
Supported Maps:
	Eastern Thanalan
Item Drops:
	Timeworn Toadskin Map
	Wind Shard
	Toadskin Treasure Map Rewards
-->

<!--User Configuration-->
<!DOCTYPE Profile [
  <!ENTITY TreasureComplete "&quot;You defeat all the enemies drawn by the trap&quot;">
  <!--Change to your localized text for your client-->
]>
<!--End User Configuration-->

<Profile>
	<Name>[O] I Can Dig It III</Name>
	<KillRadius>90</KillRadius>
	<GrindAreas>
		<GrindArea name="Coerthas_Central_Highlands">
			<Hotspots>
				<Hotspot Radius="90" XYZ="461.6874, 306.0154, -286.4336" name="Treasure Chest Mobs" />
			</Hotspots>
			<TargetMobs>
				<TargetMob Id="2425" />
				<TargetMob Id="2426" />
				<TargetMob Id="2427" />
			</TargetMobs>
			<MinLevel>1</MinLevel>
			<MaxLevel>61</MaxLevel>
		</GrindArea>
		<GrindArea name="Eastern_La_Noscea">
			<Hotspots>
				<Hotspot Radius="90" XYZ="-100.3973, 62.58618, 680.2772" name="Treasure Chest Mobs" />
			</Hotspots>
			<TargetMobs>
				<TargetMob Id="2431" />
				<TargetMob Id="2432" />
				<TargetMob Id="2406" />
			</TargetMobs>
			<MinLevel>1</MinLevel>
			<MaxLevel>61</MaxLevel>
		</GrindArea>
		<GrindArea name="Eastern_Thanalan">
			<Hotspots>
				<Hotspot Radius="90" XYZ="-238.394, -37.84665, 117.8254" name="Treasure Chest Mobs" />
			</Hotspots>
			<TargetMobs>
				<TargetMob Id="2425" />
				<TargetMob Id="2426" />
				<TargetMob Id="2427" />
			</TargetMobs>
			<MinLevel>1</MinLevel>
			<MaxLevel>61</MaxLevel>
		</GrindArea>
		<GrindArea name="Middle_La_Noscea">
			<Hotspots>
				<Hotspot Radius="90" XYZ="-72.7352, 12.20028, -410.132" name="Treasure Chest Mobs" />
			</Hotspots>
			<TargetMobs>
				<TargetMob Id="2422" />
				<TargetMob Id="2423" />
				<TargetMob Id="2424" />
			</TargetMobs>
			<MinLevel>1</MinLevel>
			<MaxLevel>61</MaxLevel>
		</GrindArea>
		<GrindArea name="South_Shroud">
			<Hotspots>
				<Hotspot Radius="90" XYZ="-222.0148, 3.691676, 544.2563" name="Treasure Chest Mobs" />
			</Hotspots>
			<TargetMobs>
				<TargetMob Id="2419" />
			</TargetMobs>
			<MinLevel>1</MinLevel>
			<MaxLevel>61</MaxLevel>
		</GrindArea>
		<GrindArea name="Upper_La_Noscea_1">
			<Hotspots>
				<Hotspot Radius="90" XYZ="-586.9598, -1.496248, -9.511739" name="Treasure Chest Mobs" />
			</Hotspots>
			<TargetMobs>
				<TargetMob Id="2431" />
				<TargetMob Id="2432" />
				<TargetMob Id="2406" />
				<TargetMob Id="2420" />
				<TargetMob Id="2421" />
			</TargetMobs>
			<MinLevel>1</MinLevel>
			<MaxLevel>61</MaxLevel>
		</GrindArea>
		<GrindArea name="Upper_La_Noscea_2">
			<Hotspots>
				<Hotspot Radius="90" XYZ="-460.857, -12.536, 216.8715" name="Treasure Chest Mobs" />
			</Hotspots>
			<TargetMobs>
				<TargetMob Id="2431" />
				<TargetMob Id="2432" />
				<TargetMob Id="2406" />
			</TargetMobs>
			<MinLevel>1</MinLevel>
			<MaxLevel>61</MaxLevel>
		</GrindArea>
		<GrindArea name="Upper_La_Noscea_3">
			<Hotspots>
				<Hotspot Radius="90" XYZ="347.2499, 27.19416, -153.0971" name="Treasure Chest Mobs" />
			</Hotspots>
			<TargetMobs>
				<TargetMob Id="2420" />
				<TargetMob Id="2421" />
			</TargetMobs>
			<MinLevel>1</MinLevel>
			<MaxLevel>61</MaxLevel>
		</GrindArea>
	</GrindAreas>
	<Order>

		<!-- Timeworn Toadskin Map -->

		<!-- To Do: Possible to Check if an Achievement is Complete? -->

		<!-- To Do: Possible to Check if the 18 Hour Timer is Active? -->

		<If Condition="not HasAtLeast(2001089,1)">

			<If Condition="(ItemCount(6690) &lt; 1)">

				<RunCode Name="Miner" />

				<If Condition="not IsOnMap(147)">
					<TeleportTo Name="Camp Bluefog" AetheryteId="21" />
				</If>

				<MoveTo Name="Farming Area" XYZ="85.05799, 21.02174, 158.1695" />
				<Dismount />
				<RunCode Name="MinerStealth" />
				<RunCode Name="DisableMount" />

			    <Gather while="(ItemCount(6690) &lt; 1)">
					<GatherObject>Mineral Deposit</GatherObject>
					<HotSpots>
						<HotSpot Radius="90" XYZ="61.27651, 24.57406, 114.1706" name="Mineral Deposit" />
						<HotSpot Radius="90" XYZ="85.05799, 21.02174, 158.1695" name="Mineral Deposit" />
					</HotSpots>
					<ItemNames>
						<ItemName>Timeworn Toadskin Map</ItemName>
						<ItemName>Wind Shard</ItemName>
					</ItemNames>
			  	</Gather>

			  	<RunCode Name="EnableMount" />

			</If>

		  	<If Condition="(ItemCount(6690) &gt; 0)">
		  		
		  		<LogMessage Message="You've found your daily treasure map!" />
		  		<LogMessage Message="Opening the map is not yet supported." />
		  		<LogMessage Message="Please Decipher your map, then re-run this profile." />

		  		<!-- To Do: Open the Bottle -->

		  		<!-- <UseItem ItemId="6690" XYZ="85.05799, 21.02174, 158.1695" /> -->

				<!-- <If Condition="not IsOnMap(147)">
					<TeleportTo Name="Camp Bluefog" AetheryteId="21" />
				</If>

				<WaitTimer WaitTime="5" />
				<MoveTo Name="Farming Area" XYZ="85.05799, 21.02174, 158.1695" />
				<Dismount />
				<WaitTimer WaitTime="1" />
		  		<UseSpell SpellId="1694" NpcId="6690" XYZ="85.05799, 21.02174, 158.1695" />
		  		<WaitTimer WaitTime="3" />
				<LogMessage Message="You've found your daily treasure map!" /> -->

			</If>
			
		</If>

		<!-- Toadskin Treasure Chest -->

		<If Condition="HasAtLeast(2001089,1)">

			<LogMessage Message="Let's go find your daily treasure!" />
			<RunCode Name="Combat" />

			<!-- To Do: Possible to Check for Treasure Map Location? -->

			<!-- Upper La Noscea #1 (3 Waves) -->

			<If Condition="not IsOnMap(138)">
				<If Condition="Managers.WorldManager.HasAetheryteId(14)">
					<TeleportTo Name="Aleport" AetheryteId="14" />
				</If>
				<If Condition="not Managers.WorldManager.HasAetheryteId(14)">
					<Travel To="138" />
				</If>
			</If>

			<Travel To="139" />

			<MoveTo Name="Dig Area" XYZ="-586.9598, -1.496248, -9.511739" />
			<Dismount />
			<UseSpell SpellID="1695" XYZ="-586.9598, -1.496248, -9.511739" />
			<WaitTimer WaitTime="5" />

			<!-- To Do: Check for Treasure Coffer Spawn -->

			<!-- <If Condition="GameObjectManager.GetObjectByNPCId(2896)"> -->
				<YesUseObject NpcId="2896" XYZ="-586.9598, -1.496248, -9.511739" />
				<Grind grindRef="Upper_La_Noscea_1" while="not ff14bot.ManagersChatLogEntry.Contents.Contains(&TreasureComplete;)" />
				<WaitTimer WaitTime="5" />
				
				<If Condition="GameObjectManager.GetObjectByNPCId(2896)">
					<UseObject NpcId="2896" XYZ="-586.9598, -1.496248, -9.511739" />
				</If>

				<WaitTimer WaitTime="5" />
				
				<If Condition="not HasAtLeast(2001089,1)">
					<LogMessage Message="Your treasure is in your bags." />
					<LogMessage Message="Check back again tomorrow for more treasure!" />
					<StopBot />
				</If>
			<!-- </If> -->

			<!-- Upper La Noscea #2 ( Waves) -->

			<If Condition="not IsOnMap(138)">
				<If Condition="Managers.WorldManager.HasAetheryteId(14)">
					<TeleportTo Name="Aleport" AetheryteId="14" />
				</If>
				<If Condition="not Managers.WorldManager.HasAetheryteId(14)">
					<Travel To="138" />
				</If>
			</If>

			<Travel To="139" />

			<MoveTo Name="Dig Area" XYZ="-460.857, -12.536, 216.8715" />
			<Dismount />
			<UseSpell SpellID="1695" XYZ="-460.857, -12.536, 216.8715" />
			<WaitTimer WaitTime="5" />

			<!-- To Do: Check for Treasure Coffer Spawn -->

			<!-- <If Condition="GameObjectManager.GetObjectByNPCId(2896)"> -->
				<YesUseObject NpcId="2896" XYZ="-460.857, -12.536, 216.8715" />
				<Grind grindRef="Upper_La_Noscea_2" while="not ff14bot.ManagersChatLogEntry.Contents.Contains(&TreasureComplete;)" />
				<WaitTimer WaitTime="5" />
				
				<If Condition="GameObjectManager.GetObjectByNPCId(2896)">
					<UseObject NpcId="2896" XYZ="-460.857, -12.536, 216.8715" />
				</If>

				<WaitTimer WaitTime="5" />
				
				<If Condition="not HasAtLeast(2001089,1)">
					<LogMessage Message="Your treasure is in your bags." />
					<LogMessage Message="Check back again tomorrow for more treasure!" />
					<StopBot />
				</If>
			<!-- </If> -->

			<!-- Upper La Noscea #3 (3 Waves) -->

			<TeleportTo Name="Camp Bronze Lake" AetheryteId="15" />

			<MoveTo Name="Dig Area" XYZ="347.2499, 27.19416, -153.0971" />
			<Dismount />
			<UseSpell SpellID="1695" XYZ="347.2499, 27.19416, -153.0971" />
			<WaitTimer WaitTime="5" />

			<!-- To Do: Check for Treasure Coffer Spawn -->

			<!-- <If Condition="GameObjectManager.GetObjectByNPCId(2896)"> -->
				<YesUseObject NpcId="2896" XYZ="347.2499, 27.19416, -153.0971" />
				<Grind grindRef="Upper_La_Noscea_3" while="not ff14bot.ManagersChatLogEntry.Contents.Contains(&TreasureComplete;)" />
				<WaitTimer WaitTime="5" />
				
				<If Condition="GameObjectManager.GetObjectByNPCId(2896)">
					<UseObject NpcId="2896" XYZ="347.2499, 27.19416, -153.0971" />
				</If>

				<WaitTimer WaitTime="5" />
				
				<If Condition="not HasAtLeast(2001089,1)">
					<LogMessage Message="Your treasure is in your bags." />
					<LogMessage Message="Check back again tomorrow for more treasure!" />
					<StopBot />
				</If>
			<!-- </If> -->

			<!-- To Do: Other Areas -->

		</If>

		<LogMessage Message="Check back again tomorrow for more treasure!" />
        <StopBot />

	</Order>
	<CodeChunks>
		<CodeChunk Name="Combat">
			<![CDATA[
				ff14bot.Managers.ChatManager.SendChat("/gs change 1");
			]]>
		</CodeChunk>
		<CodeChunk Name="Miner">
			<![CDATA[
				ff14bot.Managers.ChatManager.SendChat("/gs change 10");
			]]>
		</CodeChunk>
		<CodeChunk Name="MinerStealth">
		<![CDATA[
			SpellData data;
			if (!Core.Me.HasAura(47) && Actionmanager.CurrentActions.TryGetValue(229, out data) && Actionmanager.CanCast(data, Core.Me)) Actionmanager.DoAction(229, Core.Me);
		]]>
		</CodeChunk>
		<CodeChunk Name="DisableMount">
		<![CDATA[
			ff14bot.Settings.CharacterSettings.Instance.UseMount = false;
		]]>
		</CodeChunk>
		<CodeChunk Name="EnableMount">
		<![CDATA[
			ff14bot.Settings.CharacterSettings.Instance.UseMount = true;
		]]>
		</CodeChunk>
	</CodeChunks>
</Profile>
