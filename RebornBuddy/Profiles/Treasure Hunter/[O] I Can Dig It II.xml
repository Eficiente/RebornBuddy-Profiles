<?xml version="1.0" encoding="utf-8"?>
<!--
Profile: [O] I Can Dig It II
Author: y2krazy
Version: 1.0.0
Required Level: 45
Required Teleport Location:
	
	Wineport
Required User Interaction:
	This profile should be AFKable.
Required Setup:
	Acquire  and Wineport Aetherytes
	Set Gear Set #1 to your preferred combat class.
	Set Gear Set #12 to Fisher.
	ONLY run once per day - you can only get 1 map every 18 hours.
Item Drops:
	Timeworn Goatskin Map
	 Shard
	Goatskin Treasure Map Rewards (Not Yet Implemented)
-->

<!--User Configuration-->
<!DOCTYPE Profile [
  <!ENTITY TreasureComplete "&quot;You defeat all the enemies drawn by the trap&quot;">
  <!--Change to your localized text for your client-->
]>
<!--End User Configuration-->

<Profile>
	<Name>[O] I Can Dig It II</Name>
	<KillRadius>90</KillRadius>
	<GrindAreas>
		<GrindArea name="">
			<Hotspots>
				<Hotspot Radius="90" XYZ="" name="Treasure Chest Mobs" />
			</Hotspots>
			<TargetMobs>
				<TargetMob Id="1" />
			</TargetMobs>
			<MinLevel>1</MinLevel>
			<MaxLevel>61</MaxLevel>
		</GrindArea>
	</GrindAreas>
	<Order>
		<BotSettings AutoEquip="1" />

		<!-- Timeworn Goatskin Map -->

		<!-- To Do: Possible to Check if an Achievement is Complete? -->

		<!-- To Do: Possible to Check if the 18 Hour Timer is Active? -->

		<If Condition="not HasAtLeast(2001088,1)">

			<If Condition="(ItemCount(6689) &lt; 1)">

				<RunCode Name="Fisher" />

				<If Condition="not IsOnMap()">
					<TeleportTo Name="" AetheryteId="" />
				</If>

				<MoveTo Name="Farming Area" XYZ="">
				<Dismount />
				<RunCode Name="FisherStealth" />
				<RunCode Name="DisableMount" />

				<!-- Bait Required: None -->

				<Fish Mooch="0" while="(ItemCount(6689) &lt; 1)">
					<FishSpots>
						<FishSpot XYZ="" Heading="" />
						<FishSpot XYZ="" Heading="" />
						<FishSpot XYZ="" Heading="" />
						<FishSpot XYZ="" Heading="" />
						<FishSpot XYZ="" Heading="" />
					</FishSpots>
				</Fish>

			  	<RunCode Name="EnableMount" />

			</If>

		  	<If Condition="(ItemCount(6689) &gt; 0)">
		  		
		  		<LogMessage Message="You've found your daily treasure map!" />
		  		<LogMessage Message="Opening the map is not yet supported." />
		  		<LogMessage Message="Please Decipher your map, then re-run this profile." />

		  		<!-- To Do: Open the Bottle -->

		  		<!-- <UseItem ItemId="6689" XYZ="85.05799, 21.02174, 158.1695" /> -->

				<!-- <If Condition="not IsOnMap(147)">
					<TeleportTo Name="Camp Bluefog" AetheryteId="21" />
				</If>

				<WaitTimer WaitTime="5" />
				<MoveTo Name="Farming Area" XYZ="85.05799, 21.02174, 158.1695" />
				<Dismount />
				<WaitTimer WaitTime="1" />
		  		<UseSpell SpellId="1694" NpcId="6689" XYZ="85.05799, 21.02174, 158.1695" />
		  		<WaitTimer WaitTime="3" />
				<LogMessage Message="You've found your daily treasure map!" /> -->

			</If>

		</If>

		<!-- Goatskin Treasure Chest -->

		<If Condition="HasAtLeast(2001088,1)">

			<LogMessage Message="Let's go find your daily treasure!" />
			<RunCode Name="Combat" />

			<!-- To Do: Possible to Check for Treasure Map Location? -->

			<!-- Outer La Noscea (3 Waves) -->

			<If Condition="not IsOnMap(180)">
				<TeleportTo Name="Camp Overlook" AetheryteId="16" />
			</If>

			<MoveTo Name="Dig Area" XYZ="191.8131, 63.62408, -276.8129" />
			<Dismount />
			<UseSpell SpellID="1695" XYZ="191.8131, 63.62408, -276.8129" />
			<WaitTimer WaitTime="5" />

			<!-- To Do: Check for Treasure Coffer Spawn -->

			<!-- <If Condition="GameObjectManager.GetObjectByNPCId(2896)"> -->
				<YesUseObject NpcId="2896" XYZ="191.8131, 63.62408, -276.8129" />
				<Grind grindRef="Outer_La_Noscea" while="not ff14bot.ManagersChatLogEntry.Contents.Contains(&TreasureComplete;)" />
				<WaitTimer WaitTime="5" />
				
				<If Condition="GameObjectManager.GetObjectByNPCId(2896)">
					<UseObject NpcId="2896" XYZ="191.8131, 63.62408, -276.8129" />
				</If>

				<WaitTimer WaitTime="5" />
				
				<If Condition="not HasAtLeast(2001088,1)">
					<LogMessage Message="Your treasure is in your bags." />
					<LogMessage Message="Check back again tomorrow for more treasure!" />
					<StopBot />
				</If>
			<!-- </If> -->

			<!-- To Do: Other Areas -->

		<!-- </If> -->

        <StopBot />

	</Order>
	<CodeChunks>
		<CodeChunk Name="Combat">
			<![CDATA[
				ff14bot.Managers.ChatManager.SendChat("/gs change 1");
			]]>
		</CodeChunk>
		<CodeChunk Name="Fisher">
			<![CDATA[
				ff14bot.Managers.ChatManager.SendChat("/gs change 12");
			]]>
		</CodeChunk>
		<CodeChunk Name="FisherStealth">
		<![CDATA[
			SpellData data;
			if (!Core.Me.HasAura(47) && Actionmanager.CurrentActions.TryGetValue(298, out data) && Actionmanager.CanCast(data, Core.Me)) Actionmanager.DoAction(298, Core.Me);
		]]>
		</CodeChunk>
		<CodeChunk Name="DisableMount">
		<![CDATA[
			ff14bot.Settings.CharacterSettings.Instance.UseMount = false;
		]]>
		</CodeChunk>
		<CodeChunk Name="EnableMount">
		<![CDATA[
			ff14bot.Settings.CharacterSettings.Instance.UseMount = true;
		]]>
		</CodeChunk>
	</CodeChunks>
</Profile>
